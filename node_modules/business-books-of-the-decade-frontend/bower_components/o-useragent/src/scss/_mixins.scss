// appends a useragent selector to an existing list of selectors
@function _oUseragentAppendSelector ($aggregate, $useragent, $version: null) {
	@if ($version) {
		$useragent: $useragent$version;
	}
	@if(not index($_o-useragent-targeted-useragents, $useragent)) {
		$_o-useragent-targeted-useragents: append($_o-useragent-targeted-useragents, $useragent);
	}
	@if (not $_o-useragent-emitted-warning) {
		@debug "The CSS includes styles intended only for specific browsers.  For more details, @include oUseragentListTargets() at the end of your CSS.";
		$_o-useragent-emitted-warning: true;
	}
	$selector: o-useragent- + $useragent;
	$aggregate: append($aggregate, #{'%#{$selector}'}, comma);
	@if (not $o-useragent-is-silent) {
		$aggregate: append($aggregate, #{'.#{$selector}'}, comma);
	}
	@return $aggregate;
}

// wraps styles aimed at a particular user agent in a class (definable at product level but defaulting to o-useragent-{useragent name})
@mixin oUseragentTarget ($useragents, $versions: null) {

	$selector: null;

	// Target at version-level (may apply only to a single browser family)
	@if (count($useragents) == 1 and $versions) {
		@each $version in $versions {
			$selector: _oUseragentAppendSelector($selector, $useragents, $version);
		}

	// Target at browser-level
	} @else {
		@each $useragent in $useragents {
			$selector: _oUseragentAppendSelector($selector, $useragent);
		}
	}
	@if ($selector) {
		#{$selector} { @content }
	}
}

@mixin oUseragentListTargets() {
	@debug "Styles are being targeted at specific browsers using the o-useragent module.";
	@if ($o-useragent-is-silent) {
		@debug "To apply them, extend %o-useragent-[UA-IDENTIFIER] in a class, and apply that class to your HTML tag, for the following user agents:"
	} @else {
		@debug "To apply them, add the class o-useragent-[UA-IDENTIFIER] to your HTML tag for the following user agents:";
	}
	@debug $_o-useragent-targeted-useragents;
}



@mixin _oUseragentSinglePrefix ($prefix, $prop, $val, $apply-prefix-to-value, $apply-prefix-to-prop) {
    @if ($apply-prefix-to-value) {
        $val: #{$prefix + $val};
    }
    @if ($apply-prefix-to-prop) {
        $prop: #{$prefix + $prop};
    }
    #{$prop}: $val;
}

@mixin oUseragentPrefixer ($prop, $val, $apply-prefix-to-value: false, $apply-prefix-to-prop: true, $prefixes: $o-useragent-vendor-prefixes) {
	@each $prefix in $prefixes {
		@if (index($o-useragent-vendor-prefixes, $prefix)) {
		    @include _oUseragentSinglePrefix(#{'-' + $prefix + '-'}, $prop, $val, $apply-prefix-to-value, $apply-prefix-to-prop);
		}
	}
    #{$prop}: $val;
}
